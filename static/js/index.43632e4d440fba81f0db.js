import{ACESFilmicToneMapping as e,AmbientLight as n,Color as t,DoubleSide as a,Group as o,LoadingManager as s,Mesh as i,MeshStandardMaterial as r,PerspectiveCamera as l,RectAreaLight as c,Scene as d,WebGLRenderer as u,sRGBEncoding as p}from"https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.module.js";import{OrbitControls as m}from"https://cdn.jsdelivr.net/npm/three@0.148.0/examples/jsm/controls/OrbitControls.js";import{GLTFLoader as h}from"https://cdn.jsdelivr.net/npm/three@0.148.0/examples/jsm/loaders/GLTFLoader.js";window.HELP_IMPROVE_VIDEOJS=!1,$("video").on("contextmenu",function(e){return e.preventDefault(),!1}),$("img").on("contextmenu",function(e){return e.preventDefault(),!1});const f=new s,g=new r({roughness:.6,metalness:.1,side:a,color:new t("#59c99c")}),w=new r({roughness:1,metalness:0,side:a,wireframe:!0}),v=$(".loading-overlay");function b(e){try{null!=O&&(_[O].visible=!1),_[e].visible=!0}catch(e){return}O=e,j.text(e)}function x(){F&&clearInterval(F),z&&clearTimeout(z)}f.onStart=()=>{v.css("display","flex"),x()},f.onLoad=()=>{v.css("display","none"),H();const e=Math.floor(_.length/2);b(e),P.val(e),k=e,F&&clearInterval(F),F=setInterval(J,60)};let y=0;const C=$("#canvas-scene"),L=$("#prev-button"),M=$("#next-button"),E=$("#canvas-container"),P=$("#interpolation-slider"),j=$("#current-step-text"),I=$("#total-steps-text"),S=$("#auto-slide-btn"),D=$(".auto-slide-btn-icon"),A=$(".auto-slide-btn-text"),R=["cat","moai","owl","potplant","tomato","onion","mug","dog","bot","bear"];let T=!0,k=0,G=1,O=null,F=null,z=null,V=null;const _=[],q=new u({canvas:C[0],antialias:!0});function B(e){T=e,T?(D.removeClass("fa-circle-play").addClass("fa-circle-pause"),A.text("Pause")):(D.removeClass("fa-circle-pause").addClass("fa-circle-play"),A.text("Play"))}function H(){const e=y-1>=0,n=y+1<=R.length-1;L.prop("disabled",!e),M.prop("disabled",!n)}function J(){T&&(k+=G,k>=parseInt(P.prop("max"))&&(G=-1),k<=parseInt(P.prop("min"))&&(G=1),P.val(k),b(k))}function W(e){x(),y+=e,H(),K(R[y])}async function K(e){O=null,_.length=0;const a=new d;a.background=new t(16777215);const s=E.width();q.setSize(s,s),V=new l(45,1,.1,100),V.position.set(15,20,30);const r=new n(16777215,1);a.add(r);const u=new c(16777215,1,20,20);a.add(u),u.position.set(0,20,0),u.lookAt(0,0,0);new h(f).load(`./static/meshes/${e}.glb`,function(e){e.scene.children[0].children.forEach(e=>{const n=new o,t=new i(e.geometry,w),a=new i(e.geometry,e.material);t.renderOrder=1,a.material.roughness=g.roughness,a.material.metalness=g.metalness,a.material.side=g.side,a.material.color=g.color,n.add(t),n.add(a),_.push(n)}),_.forEach(e=>{!function(e,n){e.add(n)}(a,e),e.visible=!1}),P.prop("max",_.length-1),I.text(_.length-1)});const p=new m(V,q.domElement);p.minDistance=1,p.maxDistance=3.5,p.maxPolarAngle=Math.PI/2,p.enableDamping=!0;const v=function(){requestAnimationFrame(v),p.update(),a.rotation.y+=.001,q.render(a,V)};v()}q.setPixelRatio(window.devicePixelRatio),q.setClearColor(16777215,1),q.physicallyCorrectLights=!0,q.outputEncoding=p,q.toneMapping=e,q.toneMappingExposure=1,S.on("click",()=>{B(!T)}),L.on("click",()=>{W(-1)}),M.on("click",()=>{W(1)}),P.on("input",function(){k=parseInt(this.value),b(k),B(!1),z&&clearTimeout(z),T&&(z=setTimeout(()=>{B(!0)},5e3))}),window.onresize=function(){const e=E.width();q.setSize(e,e),V&&V.updateProjectionMatrix()},$(function(){K(R[y]),T=!0});